## 성능 테스트 패턴 및 안티패턴

개요
다양한 테스트를 소개하고 유형별 베스트 프랙티스를 안내합니다.

### 성능 테스트 유형
- 좋은 성능 테스트는 정량적입니다. 어떤 질문을 던져도 실험 결과를 토대로 수치화한 답변을 내놓을 수 있어야 합니다.
  - 지연테스트 (latency)
  > 가장 일반적인 성능테스트이며 지연을 튜닝하는 것은 유저 경험을 직접 개선하거나 서비스 수준 협약서를 이행하기 위함입니다.

  - 처리율테스트 (throughput)
  > 동시 진행되는 트랜잭션을 반드시 명시하고 지연이 시작되는 변곡접을 찾습니다. 이 변곡점이 최대 처리율입니다.

  - 부하테스트 (load)
  > 시스템이 어느정도의 부하를 견딜 수 있는지에 대한 답을 구하는 과정입니다. 예를 들어 이벤트성 트랙픽에 대비하기 위한 부하테스트를 합니다.  

  - 스트레스테스트 (stress)
  > 일정 수준의 트랜잭션(ex.최대처리율) 을 인입시켜 어느 정도까지 견딜 수 있는지 측정하는 것입니다.

  - 내구성테스트 (endurance)
  > 시스템에 일정 부하를 주며 모니터링하다가 갑자기 리소스가 고갈되거나 시스템이 깨지는 지점을 찾습니다. 보통 빠른 응답을 요구하는 시스템에서 많이 하는 편입니다.

  - 용량계획테스트 (capacity)
  > 스트레스테스트와 비슷하지만 스트레스테스트가 현시스템에 대한 테스트라면 용량계획테스트는 업그레이드 될 시스템에 대한 테스트입니다.

  - 저하테스트 (degradation)
  > 특정 컴포넌트나 어떤 서브시스템이 망가졌을 때 벌어지는 일들을 확인합니다. 목적은 하나가 무너져도 연쇄적으로 전체적으로 시스템에 영향을 끼치지 않게 하기 위함입니다.

### 기본 베스트 프랙티스
성능 튜닝 시 주안점을 두어야 할 세 가지 원칙
```
나의 관심사가 무엇인지 식별하고 측정 방법을 고려한다
최적화하기 용이한 부분이 아니라 중요한 부분을 찾는다
중요한 관심사를 먼저 다룬다  
```

- 하향식 성능
> 전체 애플리케이션의 성능 양상부터 먼저알아보고 작은 코드별로 알아보는 접근 방식을 하향식 성능이라고 합니다. 이 방법이 더 쉽게 접근할 수 있기 때문에 선호됩니다.

- 테스트 환경 구축
> 가급적 운영환경과 동일하게 준비해야 합니다. 운영 환경과 많이 차이나는 성능 테스트 환경에서는 실제 환경에서 어떤 일들이 일어날지 예측하기 어렵고 쓸모있는 결과를 얻지 못할 가능성이 큽니다.

- 성능 요건 식별
> 성능 비기능 요건(NFR) - 어떤 것으로 성능을 식별할지 정하는 일입니다.

- 자바에 특정한 이슈
> JVM 에는 동적 튜닝 등 JVM 특유의 자기관리 기능이 추가되면서 성능 엔지니어가 잘 이해하고 주의 깊게 살펴야 할 복잡 미묘한 부분들이 있습니다. JIT 컴파일러가 어떤 메서드를 컴파일할지 결정하는 일 등은 유심히 살펴야 합니다.

- SDLC 일부로 성능 테스트 수행하기
> 개발 수명주기(SDLC)의 일부로 성능 테스트는 항상 같이 되어야 합니다.

### 성능 안티패턴
성능 테스트를 방해하는 요소들

- 지루함
- 이력서 부풀리기
- 또래 압박
- 이해 부족
- 오해와 있지도 않은 문제

### 안티패턴의 유형
- 화려함에 사로잡히다
- 단순함에 사로잡히다
- 성능 튜닝 도사
- 민간 튜닝
- 안되면 조상 탓
- 숲을 못보고 나무만 본다
- 내 데스크톱이 UAT(user acceptance testing)
- 운영 데이터처럼 만들기는 어려워

### 인지 편향과 성능 테스트
- 환원주의
- 확증 편향
- 행동 평향(전운의 그림자)
- 위험 편향
- 엘스버그 역설
