---
layout: post
title:  "Redis Cluster tutorial 2 - configuration parameter"
date:   2018-10-21 17:35:00 +0900
categories: docs redis
---

comes from <https://redis.io/topics/cluster-tutorial>

Redis Cluster 에서 설정할 수 있는 설정값에 대해 알아볼 생각입니다. 해당 설정들은 `redis.conf` 에서 설정할 수 있습니다.

* **cluster-enabled {yes/no}** : yes 일 경우에만 클러스터 지원이 됩니다. 그렇지 않은 경우 단독 인스턴스로 동작합니다.

* **cluster-config-file {filename}** : 이름만 이렇지 사용자가 수정할 수 있는 설정파일이란 뜻은 아닙니다. 변경이 있을 때마다 _Redis Cluster_ 노드가 클러스터 설정에 변동이 있을 때마다 변동사항을 자동으로 유지하기 위해 정보를 기록하는 곳입니다. 해서 재시작이 필요한 경우 다시 해당 파일 정보를 읽어 적용합니다. 이 파일에는 클러스터의 다른 노드들에 대한 정보, 노드 상태, 영속적인 변수들 등이 있습니다. 이 파일은 메세지 수시여부에 따라 자주 수정되기도하고 디스크에 보내지기도 합니다.

* **cluster-node-timeout {milliseconds}** : 복구가 필요한 상태를 판단하기 위한 최대 시간. (실패상태로 간주되는 것은 아닙니다) 마스터노드에 해당 시간 이상 접근 불가능할 경우 슬레이브가 마스터로 전환됩니다. 레디스 클러스터 설정에 매우 중요한 요소로, 주요 마스터들에 _node timeout_ 이상으로 접근 불가 상태인 노드들은 더이상 쿼리를 받아들이지 않기 때문입니다.

* **cluster-slave-validity-factor {factor}** : 0 으로 설정하면, 얼마나 오랫동안 마스터와의 연결이 끊겼었는지 상관없이 슬레이브는 항상 마스터로서 전환(_failover_)하려고 시도할 것입니다. 양수로 설정하면, 비연결 최대 허용 시간은 _node timeout_ * _factor_ 로 계산되며, 슬레이브 노드일 경우에 마스터와의 연결이 계산된 시간 이상 비연결되어 있었다면 마스터로의 전환을 시도하지 않을 것입니다. 예를들어 _node timeout_ 이 5초로 설정되어 있고 _factor_ 가 10으로 설정된 경우, 50초 이상동안 마스터와의 연결이 끊어져 있었다면 전환을 시도하지 않습니다. 또한 0이 아닌 경우, 마스터가 다운되고난 후 복구할 슬레이브가 없을 땐 레디스 클러스터는 사용불가 상태로 될 수 있습니다. 이런 경우에는 마스터가 클러스터에 다시 연결된 경우에만 다시 사용가능 상태가 됩니다.

* **cluster-migration-barrier {count}** : 마스터가 연결상태를 유지하는 최소한의 슬레이브 노드 숫자: 마스터에 슬레이브가 연결되어 있지 않을 때 다른 슬레이브를 마스터에 연결 위함입니다. 이 튜토리얼의 복제에 관한 부분에서 좀 더 살펴볼 수 있습니다.

* **cluster-require-full-coverage {yes/no}** : _yes_ 로 설정하면 (기본값) 키의 전체를 커버할 수 없고 일정량에 대해서 어떤 노드도 커버하지 못한다면 클러스터는 더이상 쓰기를 받지 않습니다. _no_ 로 설정할 경우에는 키의 일정 부분만이라도 클러스터는 해당 쿼리를 계속 진행시킬 수 있습니다.
